<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Picture Style Stealer</title>
		<script type="text/javascript" src="scripts/vectorscope.js"></script>
		<script type="text/javascript" src="scripts/waveform.js"></script>
		<script type="text/javascript" src="scripts/parade.js"></script>
		<script type="text/javascript" src="scripts/histgram.js"></script>
		<script type="text/javascript" src="scripts/palette.js"></script>
		<script type="text/javascript" src="scripts/jquery-3.4.1.min.js"></script>
		<script type="text/javascript" src="scripts/bootstrap.bundle.min.js"></script>
		<link rel="stylesheet" href="css/bootstrap-grid.min.css">
		<link rel="stylesheet" href="css/bootstrap.min.css">
		<link rel="stylesheet" href="css/main.css">
	</head>
	<body>
		<div class="container">
			<div class="row">
				<input class="col-8" type="url" id="image-url" placeholder="请输入需要分析图片的链接">
				<input class="col" type="file" id="file">
				<button class="col">分析图片</button>
			</div>	
			<div class="row">
				<div class = "col">
					<img src="" id="img" class="rounded" width=100%/>
				</div>
					<div id="palette" class = "col">
					</div>
			</div>
			<div class="row">
				<canvas id="waveform" class="col"></canvas>
				<canvas id="vectorscope" class="col"></canvas>
			</div>
			<div class="row">
				<canvas id="parade" class="col"></canvas>
				<canvas id="histgram" class="col"></canvas>
			</div>
		</div>
		

		<script type="text/javascript">
			var canvas_v = document.getElementById('vectorscope'),
				canvas_w = document.getElementById('waveform'),
				canvas_p = document.getElementById('parade'),
				canvas_h = document.getElementById('histgram'),
				div_p = document.getElementById('palette'),
				waveform = new Waveform(canvas_w),
				vectorscope = new Vectorscope(canvas_v),
				parade = new Parade(canvas_p),
				histgram = new Histgram(canvas_h),
				palette = new Palette(div_p),
				img = new Image();

			img.addEventListener('load', function() {
				vectorscope.setImage(img);
				vectorscope.refresh();
				waveform.setImage(img);
				waveform.refresh();
				parade.setImage(img);
				parade.refresh();
				histgram.setImage(img);
				histgram.refresh();	
				palette.setImage(img);
				palette.refresh();
			}, false);
			
			var imgEle = document.getElementById('img');
			var fileEle = document.getElementById('file');
			
			fileEle.onchange = function(e) {
				var file1 = e.target.files[0];
				var reader = new FileReader;
				var url2 = reader.readAsDataURL(file1);
				reader.onload = function() {
					imgEle.src = reader.result;
					img.src = reader.result;
				}
			}
		</script>
	</body>
</html>

